// Code generated by Lorm. DO NOT EDIT.

package {{.Package}}

import (
    json "github.com/bytedance/sonic"
{{range .Imports}}
    {{.Alias}} {{.Path}}
{{end}}
)

{{range $index, $struct := .Structs}}

    {{if ne $struct.TableName ""}}
        func (m *{{$struct.Name}}) TableName() string {
            return "{{$struct.TableName}}"
        }
    {{end}}

    func (m *{{$struct.Name}}) New() {{$.LormImportAlias}}.Model {
        return new({{$struct.Name}})
    }

    func (m *{{$struct.Name}}) LormFieldMap() map[string]any {
        return map[string]any{
            {{- range $struct.Fields}}
                "{{.DBField}}": &m.{{.FullName}},
            {{- end}}
        }
    }

    func (m *{{$struct.Name}}) LormModelDescriptor() *{{$.LormImportAlias}}.ModelDescriptor {
        return {{$.RawVarPrefix}}_model_descriptor_map["{{$struct.Name}}"]
    }

    func (m *{{$struct.Name}}) Fields() *{{$struct.Name}}_Fields {
        return new({{$struct.Name}}_Fields)
    }

    type {{$struct.Name}}_Fields struct {
        alias string
    }

    func (f *{{$struct.Name}}_Fields) WithAlias(alias string) *{{$struct.Name}}_Fields {
        f.alias = alias
        return f
    }

    {{- range $struct.Fields }}
        func (f *{{$struct.Name}}_Fields){{.Name}}() string {
            if f.alias == "" {
                return "{{.DBField}}"
            }
            return f.alias + ".{{.DBField}}"
        }
    {{- end}}

    func (f *{{$struct.Name}}_Fields) All() []string {
        return []string{
            {{- range $struct.Fields}}
                f.{{.Name}}(),
            {{- end}}
        }
    }

{{- end}}

const {{.RawVarPrefix}}_raw = `{{.JsonMarshal}}`

var {{.RawVarPrefix}}_model_descriptor_map = func() map[string]*{{$.LormImportAlias}}.ModelDescriptor {
    var file {{$.LormImportAlias}}.FileDescriptor
    _ = json.UnmarshalString({{.RawVarPrefix}}_raw ,&file)
    m := make(map[string]*{{$.LormImportAlias}}.ModelDescriptor,len(file.Structs))
    for _,s := range file.Structs {
        m[s.Name] = s
    }
    return m
}()